!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("phaser-navmesh-generation",[],t):"object"==typeof exports?exports["phaser-navmesh-generation"]=t():e["phaser-navmesh-generation"]=t()}(this,function(){return function(e){function t(r){if(n[r])return n[r].exports;var i=n[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,t),i.l=!0,i.exports}var n={};return t.m=e,t.c=n,t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:r})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=12)}([function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a={collisionIndices:[],timingInfo:!1,midPointThreshold:0,tileMap:null,tileLayer:null,useMidPoint:!1},u=function(){function e(){r(this,e),this._c=i({},a)}return o(e,[{key:"get",value:function(e){return this._c[e]}},{key:"set",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:a;this._c=i({},a,e)}},{key:"mapDimensions",get:function(){var e=this._c.tileMap;return{width:e.width,height:e.height,tileWidth:e.tileWidth,tileHeight:e.tileHeight,widthInPixels:e.widthInPixels,heightInPixels:e.heightInPixels}}}]),e}();t.default=new u},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){var n=e.start,r=e.end,i=t.start,o=t.end,a=n.equals(i)||n.equals(o),u=r.equals(i)||r.equals(o);return a&&u}function o(){return Phaser.Color.HSLtoRGB(Math.random(),1,.5).color}function a(e,t,n){var r=t.x-e.x,i=t.y-e.y;return(n.x-e.x)*i-r*(n.y-e.y)}function u(e,t){var n=e-t,r=n+Math.PI;return(n=r-Math.floor(r/w)*w)-Math.PI}function s(e){var t=e.start,n=e.end;return n.x<t.x?new Phaser.Line(n.x,n.y,t.x,t.y):n.x>t.x?e:n.y<t.y?new Phaser.Line(n.x,n.y,t.x,t.y):e}function l(e,t,n){var r=Phaser.Point.subtract(e,t),i=Phaser.Point.subtract(e,n);return r.cross(i)}function c(e,t,n){var r=Phaser.Point.subtract(t,e).normalize(),i=Phaser.Point.subtract(n,e).normalize();return r.dot(i)}function f(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=e.length;if(!n)return[];var r=[e[0].clone()],i=new Phaser.Point,o=0,a=void 0,u=void 0,s=void 0,f=void 0,h=void 0,d=void 0,v=void 0,p=void 0;for(o;o<n;o++)if(s=e[o],u=e[o-1],p=e[o+1],u&&p)if(s.isNarrow)r.push(s.clone());else{a=new Phaser.Line(s.x,s.y,p.x,p.y),f=l(s,u,p),h=c(s,u,p),d=f>=0,v=Math.acos(h)*(d?-1:1);var y=a.clone().rotateAround(s.x,s.y,v/2),g=y.start,b=y.end,w=y.length;i.x=g.x+(g.x-b.x)/w*t,i.y=g.y+(g.y-b.y)/w*t,r.push(i.clone())}return r.push(e[n-1].clone()),r}function h(e){var t=0,n=void 0;for(t;t<e.length;t++){var r=e[t],i=e[t+1];if(i){var o=a(r.start,r.end,i.end);n=new Phaser.Line(r.start.x,r.start.y,i.end.x,i.end.y),o||(e.splice(t,2,n),t--)}}return e}function d(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=b.default.mapDimensions,i=r.width,o=r.height,u=P*(t?-1:1),s=e.length,f=new Phaser.Point,h=0,d=void 0,v=void 0,p=void 0,y=void 0,g=void 0,w=void 0,m=void 0,x=void 0,O=void 0;for(h;h<s;h++)if(v=e[0===h?s-1:h-1],d=e[h],p=e[h===s-1?0:h+1],y=new Phaser.Line(d.x,d.y,p.x,p.y),O=a(v,d,p),w=c(d,v,p),g=l(d,v,p),x=g>=0,m=Math.acos(w)*(x?-1:1),0!==d.x&&0!==d.y&&d.x!==i&&d.y!==o){var _=y.clone().rotateAround(d.x,d.y,m/2),j=_.start,E=_.end,M=_.length;O<0?(f.x=j.x+(E.x-j.x)/M*u,f.y=j.y+(E.y-j.y)/M*u):(f.x=j.x-(E.x-j.x)/M*u,f.y=j.y-(E.y-j.y)/M*u),n.find(function(e){return e.polygon.contains(f.x,f.y)})||d.copyFrom(f)}return e}function v(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=[],i=e.length,o=0,a=void 0,u=void 0,s=function(e){a=r.find(function(t){return t.equals(e)}),a?a.addSource(e):r.push(new y.default(e))};for(o;o<i;o++)s(e[o].start),s(e[o].end);return u=d(r,t,n),u.forEach(function(e){return e.updateSources()}),e}Object.defineProperty(t,"__esModule",{value:!0}),t.areLinesEqual=i,t.getRandomColour=o,t.triarea2=a,t.angleDifference=u,t.sortLine=s,t.getCrossProduct=l,t.getDotProduct=c,t.offsetFunnelPath=f,t.optimiseEdges=h,t.offsetPolygon=d,t.offsetEdges=v;var p=n(16),y=r(p),g=n(0),b=r(g),w=2*Math.PI,P=.1},function(e,t,n){"use strict";function r(e,t,n,r,i){var o=["function ",e,"(a,l,h,",r.join(","),"){",i?"":"var i=",n?"l-1":"h+1",";while(l<=h){var m=(l+h)>>>1,x=a[m]"];return i?t.indexOf("c")<0?o.push(";if(x===y){return m}else if(x<=y){"):o.push(";var p=c(x,y);if(p===0){return m}else if(p<=0){"):o.push(";if(",t,"){i=m;"),n?o.push("l=m+1}else{h=m-1}"):o.push("h=m-1}else{l=m+1}"),o.push("}"),i?o.push("return -1};"):o.push("return i};"),o.join("")}function i(e,t,n,i){return new Function([r("A","x"+e+"y",t,["y"],i),r("P","c(x,y)"+e+"0",t,["y","c"],i),"function dispatchBsearch",n,"(a,y,c,l,h){if(typeof(c)==='function'){return P(a,(l===void 0)?0:l|0,(h===void 0)?a.length-1:h|0,y,c)}else{return A(a,(c===void 0)?0:c|0,(l===void 0)?a.length-1:l|0,y)}}return dispatchBsearch",n].join(""))()}e.exports={ge:i(">=",!1,"GE"),gt:i(">",!1,"GT"),lt:i("<",!0,"LT"),le:i("<=",!0,"LE"),eq:i("-",!0,"EQ",!0)}},function(e,t,n){"use strict";function r(e,t,n){var r=e*t,o=i*e,a=o-e,u=o-a,s=e-u,l=i*t,c=l-t,f=l-c,h=t-f,d=r-u*f,v=d-s*f,p=v-u*h,y=s*h-p;return n?(n[0]=y,n[1]=r,n):[y,r]}e.exports=r;var i=+(Math.pow(2,27)+1)},function(e,t,n){var r=n(20),i=n(22),o=i;o.v1=r,o.v4=i,e.exports=o},function(e,t,n){(function(t){var n,r=t.crypto||t.msCrypto;if(r&&r.getRandomValues){var i=new Uint8Array(16);n=function(){return r.getRandomValues(i),i}}if(!n){var o=new Array(16);n=function(){for(var e,t=0;t<16;t++)0==(3&t)&&(e=4294967296*Math.random()),o[t]=e>>>((3&t)<<3)&255;return o}}e.exports=n}).call(t,n(21))},function(e,t){function n(e,t){var n=t||0,i=r;return i[e[n++]]+i[e[n++]]+i[e[n++]]+i[e[n++]]+"-"+i[e[n++]]+i[e[n++]]+"-"+i[e[n++]]+i[e[n++]]+"-"+i[e[n++]]+i[e[n++]]+"-"+i[e[n++]]+i[e[n++]]+i[e[n++]]+i[e[n++]]+i[e[n++]]+i[e[n++]]}for(var r=[],i=0;i<256;++i)r[i]=(i+256).toString(16).substr(1);e.exports=n},function(e,t,n){"use strict";function r(e){return Array.isArray(e)?e:Array.from(e)}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=["hulls","navMesh","navMeshNodes","polygonBounds"],u=16776960,s=13123120,l={};a.forEach(function(e){return l[e]=!1});var c=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,e),this.set(null,null,t)}return o(e,[{key:"draw",value:function(e){var t=this.settings,n=t.hulls,r=t.navMesh,i=t.navMeshNodes,o=t.polygonBounds;this.initGraphics(),(n||r||i||o)&&e&&this.drawDelaunay(e)}},{key:"getWorldXY",value:function(e){var t=this.tileDimensions,n=t.width,r=t.height;return{x:e.x*n,y:e.y*r}}},{key:"drawDelaunay",value:function(e){function t(e){var i=this;n.beginFill(s,.6),n.drawPolygon(e.polygon.points.map(this.getWorldXY,this)),n.endFill();var o=r(e.edges),a=o[0],l=o.slice(1),c=this.getWorldXY(a.start),f=this.getWorldXY(a.end);n.lineStyle(2,u),n.moveTo(c.x,c.y),n.lineTo(f.x,f.y),l.forEach(function(e){var t=i.getWorldXY(e.start),r=i.getWorldXY(e.end);n.moveTo(t.x,t.y),n.lineTo(r.x,r.y)}),n.lineStyle(0),e.children.length&&e.children.forEach(t,this)}var n=this.gfx,i=this.settings,o=e.polygons,a=e.hulls.clusters;if(n.clear(),i.hulls&&a.forEach(t,this),i.navMesh&&(n.beginFill(16724991,.6),n.lineStyle(1,16777215,1),o.forEach(function(e){return n.drawPolygon(e.points)}),n.endFill()),i.navMeshNodes){n.lineStyle(3,45823,.5),o.forEach(function(e){e.neighbors.forEach(function(t){n.moveTo(e.centroid.x,e.centroid.y),n.lineTo(t.centroid.x,t.centroid.y)}),n.beginFill(16777215),n.drawCircle(e.centroid.x,e.centroid.y,10),n.endFill()})}i.polygonBounds&&(o.forEach(function(e){n.lineStyle(2,u,1),n.drawCircle(e.centroid.x,e.centroid.y,2*e.boundsRadius)}),n.lineStyle(0,16777215))}},{key:"initGraphics",value:function(){var e=this.game;this.gfx||(this.gfx=e.add.graphics(0,0))}},{key:"set",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.game=e,this.tileLayer=t,this.settings=Object.assign({},l,n),e&&this.initGraphics(),this.settings}},{key:"tileDimensions",get:function(){var e=this.tileLayer.layer.data,t=e[0][0];return{width:t.width,height:t.height}}}]),e}();t.default=new c},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o={NONE:0,UP:-1,LEFT:-1,RIGHT:1,DOWN:1},a=function(){function e(t,n){r(this,e),this.collisionIndices=n,this.grid=t}return i(e,[{key:"generate",value:function(e){var t=0,n=[],r=void 0;do{if(n=this.walkPerimeter()||{},r=n.contours||[],r.length&&e(r,n.lines),++t>=500)break}while(r.length)}},{key:"getSquareValue",value:function(e){var t=e.x,n=e.y,r=0;return this.isValidTile(t-1,n-1)&&(r+=1),this.isValidTile(t,n-1)&&(r+=2),this.isValidTile(t-1,n)&&(r+=4),this.isValidTile(t,n)&&(r+=8),r}},{key:"getStartingPoint",value:function(){}},{key:"get",value:function(e,t){var n=this.grid[t];return n&&n[e]}},{key:"isValidTile",value:function(){}},{key:"walkPerimeter",value:function(){var e=this.getStartingPoint(),t=new Phaser.Point,n=[],r=[],i=void 0,a=0;if(!e)return null;t.copyFrom(e);for(var u=new Phaser.Point,s=new Phaser.Point,l=!1;!l;){switch(this.getSquareValue(t)){case 1:case 5:case 13:u.setTo(o.NONE,o.UP);break;case 8:case 10:case 11:u.setTo(o.NONE,o.DOWN);break;case 4:case 12:case 14:u.setTo(o.LEFT,o.NONE);break;case 2:case 3:case 7:u.setTo(o.RIGHT,o.NONE);break;case 6:s.x===o.NONE&&s.y===o.UP?u.setTo(o.LEFT,o.NONE):u.setTo(o.RIGHT,o.NONE);break;case 9:s.x===o.RIGHT&&s.y===o.NONE?u.setTo(o.NONE,o.LEFT):u.setTo(o.NONE,o.RIGHT)}i=t.clone(),n.push(i),t.add(u.x,u.y),r.push(new Phaser.Line(i.x,i.y,t.x,t.y)),s.copyFrom(u),t.equals(e)&&(l=!0),a++,a>=500&&(l=!0)}return{contours:n,lines:r}}}]),e}();t.default=a},function(e,t,n){"use strict";function r(e,t){var n=e+t,r=n-e,i=n-r,o=t-r,a=e-i,u=a+o;return u?[u,n]:[n]}function i(e,t){var n=0|e.length,i=0|t.length;if(1===n&&1===i)return r(e[0],t[0]);var o,a,u=n+i,s=new Array(u),l=0,c=0,f=0,h=Math.abs,d=e[c],v=h(d),p=t[f],y=h(p);v<y?(a=d,(c+=1)<n&&(d=e[c],v=h(d))):(a=p,(f+=1)<i&&(p=t[f],y=h(p))),c<n&&v<y||f>=i?(o=d,(c+=1)<n&&(d=e[c],v=h(d))):(o=p,(f+=1)<i&&(p=t[f],y=h(p)));for(var g,b,w,P,m,x=o+a,O=x-o,_=a-O,j=_,E=x;c<n&&f<i;)v<y?(o=d,(c+=1)<n&&(d=e[c],v=h(d))):(o=p,(f+=1)<i&&(p=t[f],y=h(p))),a=j,x=o+a,O=x-o,_=a-O,_&&(s[l++]=_),g=E+x,b=g-E,w=g-b,P=x-b,m=E-w,j=m+P,E=g;for(;c<n;)o=d,a=j,x=o+a,O=x-o,_=a-O,_&&(s[l++]=_),g=E+x,b=g-E,w=g-b,P=x-b,m=E-w,j=m+P,E=g,(c+=1)<n&&(d=e[c]);for(;f<i;)o=p,a=j,x=o+a,O=x-o,_=a-O,_&&(s[l++]=_),g=E+x,b=g-E,w=g-b,P=x-b,m=E-w,j=m+P,E=g,(f+=1)<i&&(p=t[f]);return j&&(s[l++]=j),E&&(s[l++]=E),l||(s[l++]=0),s.length=l,s}e.exports=i},function(e,t,n){"use strict";function r(e,t){var n=e.length;if(1===n){var r=i(e[0],t);return r[0]?r:[r[1]]}var a=new Array(2*n),u=[.1,.1],s=[.1,.1],l=0;i(e[0],t,u),u[0]&&(a[l++]=u[0]);for(var c=1;c<n;++c){i(e[c],t,s);var f=u[1];o(f,s[0],u),u[0]&&(a[l++]=u[0]);var h=s[1],d=u[1],v=h+d,p=v-h,y=d-p;u[1]=v,y&&(a[l++]=y)}return u[1]&&(a[l++]=u[1]),0===l&&(a[l++]=0),a.length=l,a}var i=n(3),o=n(32);e.exports=r},function(e,t,n){"use strict";function r(e,t){var n=e+t,r=n-e,i=n-r,o=t-r,a=e-i,u=a+o;return u?[u,n]:[n]}function i(e,t){var n=0|e.length,i=0|t.length;if(1===n&&1===i)return r(e[0],-t[0]);var o,a,u=n+i,s=new Array(u),l=0,c=0,f=0,h=Math.abs,d=e[c],v=h(d),p=-t[f],y=h(p);v<y?(a=d,(c+=1)<n&&(d=e[c],v=h(d))):(a=p,(f+=1)<i&&(p=-t[f],y=h(p))),c<n&&v<y||f>=i?(o=d,(c+=1)<n&&(d=e[c],v=h(d))):(o=p,(f+=1)<i&&(p=-t[f],y=h(p)));for(var g,b,w,P,m,x=o+a,O=x-o,_=a-O,j=_,E=x;c<n&&f<i;)v<y?(o=d,(c+=1)<n&&(d=e[c],v=h(d))):(o=p,(f+=1)<i&&(p=-t[f],y=h(p))),a=j,x=o+a,O=x-o,_=a-O,_&&(s[l++]=_),g=E+x,b=g-E,w=g-b,P=x-b,m=E-w,j=m+P,E=g;for(;c<n;)o=d,a=j,x=o+a,O=x-o,_=a-O,_&&(s[l++]=_),g=E+x,b=g-E,w=g-b,P=x-b,m=E-w,j=m+P,E=g,(c+=1)<n&&(d=e[c]);for(;f<i;)o=p,a=j,x=o+a,O=x-o,_=a-O,_&&(s[l++]=_),g=E+x,b=g-E,w=g-b,P=x-b,m=E-w,j=m+P,E=g,(f+=1)<i&&(p=-t[f]);return j&&(s[l++]=j),E&&(s[l++]=E),l||(s[l++]=0),s.length=l,s}e.exports=i},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(13),c=r(l),f=n(0),h=r(f),d=n(7),v=r(d),p=function(e){function t(e,n){return i(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n))}return a(t,e),s(t,[{key:"buildFromTileLayer",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=Object.assign({},l.defaultOptions,n);return e&&t?(h.default.set(u({tileMap:e,tileLayer:t},n)),v.default.set(this.game,t,n.debug),this.navMesh?this.navMesh.generate(r):this.navMesh=new c.default(this.game),this.navMesh):console.error("[NavMeshPlugin] no TileMap / TileLayer found")}}]),t}(Phaser.Plugin);t.default=p,window.NavMeshPlugin=p},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=n(14),u=r(a),s=n(7),l=r(s),c=n(1),f=n(24),h=r(f),d=n(0),v=r(d),p=function(){function e(t){i(this,e),this.game=t,this.delaunay=new h.default,this.generate()}return o(e,[{key:"generate",value:function(){var e="[NavMeshPlugin] 🛠 Building NavMesh. Beep Boop Boop 🤖",t=v.default.get("collisionIndices");t&&t.length||console.error("[NavMeshPlugin] No collision-indices found, cannot generate NavMesh. Exiting..."),v.default.get("timingInfo")&&console.time(e),this.delaunay.generate(),this.aStar=new u.default(this),v.default.get("timingInfo")&&console.timeEnd(e),l.default.draw(this.delaunay)}},{key:"getPath",value:function(e,t,n){var r="[NavMeshPlugin] 🛠 Search for optimal path...",i=this.aStar;v.default.get("timingInfo")&&console.time(r);var o=i.search(e,t);if(!o)return v.default.get("timingInfo")&&console.timeEnd(r),!1;var a=o.path,u=o.polygons,s=o.uuid,l=(0,c.offsetFunnelPath)(a,n);return v.default.get("timingInfo")&&console.timeEnd(r),{path:a,polygons:u,offsetPath:l,uuid:s}}},{key:"getPolygonByXY",value:function(e,t){return this.delaunay.polygons.find(function(n){return n.contains(e,t)})}}]),e}();t.default=p},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=n(15),u=r(a),s=n(23),l=r(s),c=function(){function e(t){i(this,e),this.navMesh=t}return o(e,[{key:"search",value:function(e,t){var n=this.navMesh,r=n.getPolygonByXY(e.x,e.y),i=n.getPolygonByXY(t.x,t.y),o=[];if(!r||!i)return!1;var a=new l.default({low:!0}),s=[],c={},f={},h=0,d=!0,v=void 0,p=void 0,y=void 0;for(c[r.uuid]=null,f[r.uuid]=0,a.push(r,r.distanceTo(i));!a.empty();){if(h>=1e3){console.error("TOO MANY WHILE CYCLES - GETTING OUTTA HERE"),d=!1;break}if((y=a.top())===i){for(var g=i;null!==g;)o.push(g),g=c[g.uuid];break}a.pop(),s.push(y),p=y.neighbors.length,v=0;for(v;v<p;v++)!function(){var e=y.neighbors[v];s.find(function(t){return t===e})||a.includes(e)||(f[e.uuid]=f[y.uuid]+y.distanceTo(e),c[e.uuid]=y,a.push(e,f[e.uuid]+e.distanceTo(i)))}();h++}return new u.default(o,{start:e,end:t,startPolygon:r,endPolygon:i,isConnected:d})}}]),e}();t.default=c},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=n(1),u=n(17),s=r(u),l=n(0),c=r(l),f=n(4),h=r(f),d=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};i(this,e);var r=n.start,o=n.end,a=n.startPolygon,u=n.endPolygon,s=n.isConnected;this.polygons=t,this.isConnected=s,this.startPoint=r,this.endPoint=o,this.startPolygon=a,this.endPolygon=u,this.portals=[],this.uuid=(0,h.default)(),this.initPortals(),this.initFunnel()}return o(e,[{key:"initPortals",value:function(){var e=this.polygons,t=e.length,n=0,r=void 0,i=void 0,o=void 0;for(this.portals=[],n;n<t;n++)r=e[n],(i=e[n+1])&&(o=r.portals.find(function(e){return i.portals.find(function(t){return(0,a.areLinesEqual)(t,e)})}))&&this.portals.push(o);this.portals.reverse()}},{key:"initFunnel",value:function(){var e=this.portals,t=this.startPoint,n=this.endPoint,r=c.default.get("midPointThreshold"),i=e.length,o=0;for(this.funnel=new s.default(r),this.funnel.add(t),o;o<i;o++)this.funnel.add(e[o].start,e[o].end);this.funnel.add(n),this.funnel.update()}},{key:"path",get:function(){return this.funnel.path}}]),e}();t.default=d},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=function(e){function t(e){r(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e.x,e.y));return n.sources=[e],n}return o(t,e),a(t,[{key:"addSource",value:function(e){this.sources.push(e)}},{key:"updateSources",value:function(){var e=this.sources,t=this.x,n=this.y;e.forEach(function(e){return e.setTo(t,n)})}}]),t}(Phaser.Point);t.default=u},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=n(18),u=r(a),s=n(1),l=n(19),c=r(l),f=function(){function e(t){i(this,e),this.path=[],this.portals=[],this.midPointThreshold=t}return o(e,[{key:"add",value:function(e,t){return this.portals.push(new u.default(e,t||e))}},{key:"addPointToPath",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.path;n.find(function(t){return t.equals(e)})||n.push(new c.default(e.x,e.y,t))}},{key:"update",value:function(){var e=this,t=this.path,n=this.portals,r=this.midPointThreshold,i=n.length,o=0,a=0,u=0,l=n[0].left,c=n[0].left,f=n[0].right,h=1,d=void 0,v=void 0;this.addPointToPath(l);var p=function(t,n){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];e.addPointToPath(t,r),l=t,o=n,c=l,f=l,a=o,u=o,h=o};for(h;h<i;h++)if(d=n[h].left,v=n[h].right,n[h].isTooNarrow(r))p(n[h].midPoint,h,!0);else{if((0,s.triarea2)(l,f,v)<=0){if(!(l.equals(f)||(0,s.triarea2)(l,c,v)>0)){p(c,a);continue}f=v,u=h}if((0,s.triarea2)(l,c,d)>=0){if(!(l.equals(c)||(0,s.triarea2)(l,f,d)<0)){p(f,u);continue}c=d,a=h}}t.length&&t[t.length-1].equals(n[i-1].left)||this.addPointToPath(n[n.length-1].left)}}]),e}();t.default=f},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function(){function e(t,n){r(this,e),this.left=t,this.right=n,this.midPoint=Phaser.Point.centroid([t,n]),this.length=Phaser.Point.distance(t,n)}return i(e,[{key:"isTooNarrow",value:function(e){return this.length&&this.length<e}}]),e}();t.default=o},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(e){function t(e,n){var o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];r(this,t);var a=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return a.isNarrow=o,a}return o(t,e),t}(Phaser.Point);t.default=a},function(e,t,n){function r(e,t,n){var r=t&&n||0,i=t||[];e=e||{};var a=void 0!==e.clockseq?e.clockseq:s,f=void 0!==e.msecs?e.msecs:(new Date).getTime(),h=void 0!==e.nsecs?e.nsecs:c+1,d=f-l+(h-c)/1e4;if(d<0&&void 0===e.clockseq&&(a=a+1&16383),(d<0||f>l)&&void 0===e.nsecs&&(h=0),h>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");l=f,c=h,s=a,f+=122192928e5;var v=(1e4*(268435455&f)+h)%4294967296;i[r++]=v>>>24&255,i[r++]=v>>>16&255,i[r++]=v>>>8&255,i[r++]=255&v;var p=f/4294967296*1e4&268435455;i[r++]=p>>>8&255,i[r++]=255&p,i[r++]=p>>>24&15|16,i[r++]=p>>>16&255,i[r++]=a>>>8|128,i[r++]=255&a;for(var y=e.node||u,g=0;g<6;++g)i[r+g]=y[g];return t||o(i)}var i=n(5),o=n(6),a=i(),u=[1|a[0],a[1],a[2],a[3],a[4],a[5]],s=16383&(a[6]<<8|a[7]),l=0,c=0;e.exports=r},function(e,t){var n;n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t,n){function r(e,t,n){var r=t&&n||0;"string"==typeof e&&(t="binary"==e?new Array(16):null,e=null),e=e||{};var a=e.random||(e.rng||i)();if(a[6]=15&a[6]|64,a[8]=63&a[8]|128,t)for(var u=0;u<16;++u)t[r+u]=a[u];return t||o(a)}var i=n(5),o=n(6);e.exports=r},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){return t.priority-e.priority}function o(e,t){return e.priority-t.priority}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};r(this,e),this.contents=[],this.sorted=!1,this.sortStyle=t.low?i:o}return a(e,[{key:"pop",value:function(){this.sorted||this.sort();var e=this.contents.pop();return e?e.object:null}},{key:"top",value:function(){this.sorted||this.sort();var e=this.contents[this.contents.length-1];return e?e.object:null}},{key:"includes",value:function(e){return!!this.contents.find(function(t){return t===e})}},{key:"empty",value:function(){return 0===this.contents.length}},{key:"push",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.contents.push({object:e,priority:t}),this.sorted=!1,n&&this.sort()}},{key:"sort",value:function(){this.contents.sort(this.sortStyle),this.sorted=!0}}]),e}();t.default=u},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=n(25),u=r(a),s=n(27),l=r(s),c=n(1),f=n(28),h=r(f),d=n(0),v=r(d),p=function(){function e(){i(this,e),this.points=[],this.polygons=[]}return o(e,[{key:"calculateClusterNeighbours",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=e.length,n=0,r=void 0,i=void 0;for(n;n<t;n++){r=e[n];for(var o=n+1;o<t;o++){i=e[o];var a=!0,u=!1,s=void 0;try{for(var l,f=r.edges[Symbol.iterator]();!(a=(l=f.next()).done);a=!0){var h=l.value,d=!0,v=!1,p=void 0;try{for(var y,g=i.edges[Symbol.iterator]();!(d=(y=g.next()).done);d=!0){var b=y.value;if((0,c.areLinesEqual)(h,b)){var w=(0,c.sortLine)(h),P=w.start,m=w.end;r.addNeighbor(i),i.addNeighbor(r),r.addPortalFromEdge(h,P,m),i.addPortalFromEdge(b,P,m)}}}catch(e){v=!0,p=e}finally{try{!d&&g.return&&g.return()}finally{if(v)throw p}}}}catch(e){u=!0,s=e}finally{try{!a&&f.return&&f.return()}finally{if(u)throw s}}}}}},{key:"generate",value:function(){var e=this,t={exterior:!1};this.hulls=new u.default,this.parseHullClusters();var n=function(e){var t=e.children,n=[];return t.forEach(function(t){return n=n.concat((0,c.offsetEdges)(t.edges,!1,e.children))}),n},r=function r(i){var o=[];i.children.forEach(function(e){var a=i.edges,u=(0,c.offsetEdges)(e.edges,!0,e.children),s=n(e);new h.default(u,a,s,t).polygons.forEach(function(e){return o.push(new l.default(e))}),e.children.length&&e.children.forEach(r)}),e.polygons=e.polygons.concat(o),e.calculateClusterNeighbours(o)};this.hulls.clusters.forEach(r)}},{key:"parseHullClusters",value:function(){var e=this,t=this.hulls,n=v.default.mapDimensions,r=n.width,i=n.height,o=[new Phaser.Line(0,0,r,0),new Phaser.Line(r,0,r,i),new Phaser.Line(r,i,0,i),new Phaser.Line(0,i,0,0)],a=[];this.polygons=[],t.clusters.forEach(function(e){return a=a.concat((0,c.offsetEdges)(e.edges,!1,t.clusters))}),new h.default(a,o,[],{interior:!1}).polygons.forEach(function(t){return e.polygons.push(new l.default(t))}),this.calculateClusterNeighbours(this.polygons)}}]),e}();t.default=p},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=function e(t,n,r){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,n);if(void 0===i){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,r)}if("value"in i)return i.value;var a=i.get;if(void 0!==a)return a.call(r)},l=n(8),c=r(l),f=n(26),h=r(f),d=n(0),v=r(d),p=function(e){function t(){i(this,t);var e=v.default.get("tileLayer").layer.data,n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,v.default.get("collisionIndices")));return n.generate(),n}return a(t,e),u(t,[{key:"generate",value:function(){var e=this,n=this.grid,r=this.collisionIndices;this.clusters=[],s(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"generate",this).call(this,function(t,i){e.clusters.push(new h.default(t,i,n,r))})}},{key:"getStartingPoint",value:function(){var e=this.grid,t=e.length,n=e[0].length,r=0,i=void 0,o=new Phaser.Point;for(r;r<t;r++)for(i=0;i<n;i++)if(o.x=i,o.y=r,this.isValidTile(i,r))return o;return null}},{key:"isValidTile",value:function(e,t){var n=this.collisionIndices;if(this.isPartOfCluster(e,t))return!1;var r=this.get(e,t);return r&&n.indexOf(r.index)>-1}},{key:"isPartOfCluster",value:function(e,t){var n=this.clusters,r=n.length,i=0;for(i;i<r;i++)if(n[i].polygon.contains(e,t))return!0;return!1}}]),t}(c.default);t.default=p},function(e,t,n){"use strict";function r(e){return Array.isArray(e)?e:Array.from(e)}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=function e(t,n,r){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,n);if(void 0===i){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,r)}if("value"in i)return i.value;var a=i.get;if(void 0!==a)return a.call(r)},l=n(1),c=n(8),f=function(e){return e&&e.__esModule?e:{default:e}}(c),h=function(e){function t(e,n,r,a){var u=arguments.length>4&&void 0!==arguments[4]&&arguments[4];i(this,t);var s=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,r,a));return s.polygon=new Phaser.Polygon(e),s.edges=n,s.invert=u,(0,l.optimiseEdges)(s.edges),s.setBounds(),s.generate(),s}return a(t,e),u(t,[{key:"generate",value:function(){var e=this,n=this.collisionIndices,r=this.grid,i=this.invert;this.children=[],s(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"generate",this).call(this,function(o,a){e.children.push(new t(o,a,r,n,!i))})}},{key:"getStartingPoint",value:function(){var e=new Phaser.Point,t=this.bounds,n=t.x,r=t.y,i=t.width,o=t.height,a=r+o,u=n+i,s=r,l=void 0;for(s;s<a;s++)for(l=n;l<u;l++)if(e.x=l,e.y=s,this.isValidTile(l,s))return e;return null}},{key:"get",value:function(e,t){var n=this.bounds,r=n.x,i=n.y,o=n.width,a=n.height;if(e<r||e>o+r||t<i||t>a+i)return!1;var u=this.grid[t];return u&&u[e]}},{key:"isValidTile",value:function(e,t){var n=this.collisionIndices,r=this.invert,i=this.polygon,o=this.get(e,t);return!(!i.contains(e,t)||this.isChild(e,t)||!o)&&(r?n.indexOf(o.index)>-1:-1===n.indexOf(o.index))}},{key:"isChild",value:function(e,t){var n=this.children,r=n.length,i=0;for(i;i<r;i++)if(n[i].polygon.contains(e,t))return!0;return!1}},{key:"setBounds",value:function(){var e=r(this.edges),t=e[0],n=e.slice(1),i=Math.min(t.start.x,t.end.x),o=Math.min(t.start.y,t.end.y),a=Math.max(t.start.x,t.end.x),u=Math.max(t.start.y,t.end.y);n.forEach(function(e){var t=e.start,n=e.end,r=Math.min(t.x,n.x),s=Math.min(t.y,n.y),l=Math.max(t.x,n.x),c=Math.max(t.y,n.y);i=r<i?r:i,o=s<o?s:o,a=l>a?l:a,u=c>u?c:u}),this.bounds={x:i,y:o,width:a-i,height:u-o}}}]),t}(f.default);t.default=h},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(4),s=function(e){return e&&e.__esModule?e:{default:e}}(u),l=n(1),c=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];r(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.centroid=Phaser.Point.centroid(n.points),n.edges=[],n.neighbors=[],n.portals=[],n.uuid=(0,s.default)(),n.initialiseEdges(),n.initialiseRadius(),n}return o(t,e),a(t,[{key:"addNeighbor",value:function(e){this.neighbors.push(e)}},{key:"addPortalFromEdge",value:function(e,t,n){var r=this.centroid,i=this.portals,o=r.angle(e.start),a=r.angle(t),u=r.angle(n);(0,l.angleDifference)(o,a)>(0,l.angleDifference)(o,u)?i.push(new Phaser.Line(t.x,t.y,n.x,n.y)):i.push(new Phaser.Line(n.x,n.y,t.x,t.y))}},{key:"distanceTo",value:function(e){return this.centroid.distance(e.centroid)}},{key:"initialiseEdges",value:function(){var e=this.points,t=e.length,n=0,r=void 0;for(n;n<t;n++)for(r=n;r<t;r++)n!==r&&this.edges.push(new Phaser.Line(e[n].x,e[n].y,e[r].x,e[r].y))}},{key:"initialiseRadius",value:function(){var e=this.centroid,t=this.points,n=t.length,r=0,i=void 0,o=0,a=void 0;for(o;o<n;o++)i=t[o],(a=e.distance(i))>r&&(r=a);this.boundsRadius=a}}]),t}(Phaser.Polygon);t.default=c},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=n(29),u=r(a),s=n(0),l=r(s),c=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};i(this,e),this.points=[],this.edges=[],this.polygons=[],this.options=o,this.generate(t,n,r)}return o(e,[{key:"addPoint",value:function(e){var t=e.x,n=e.y,r=l.default.mapDimensions,i=r.tileWidth,o=r.tileHeight,a=this.points,u=a.findIndex(function(e){return e[0]===t*i&&e[1]===n*o});return-1!==u?u:(a.push([t*i,n*o]),a.length-1)}},{key:"generate",value:function(e,t,n){var r=this,i=this.edges,o=this.points,a=this.options,s=void 0,c=void 0,f=void 0,h=void 0,d=function(e){s=r.addPoint(e.start),c=r.addPoint(e.end),l.default.get("useMidPoint")&&(f=r.addPoint(e.midPoint()))},v=function(){l.default.get("useMidPoint")?(i.push([s,f]),i.push([f,c])):i.push([s,c])};t.forEach(d,this),n.forEach(function(e){d(e),v()}),e.forEach(function(e){d(e),v()}),h=(0,u.default)(o,i,a)||[],this.polygons=h.map(function(e){return e.map(function(e){return o[e]})})}}]),e}();t.default=c},function(e,t,n){"use strict";function r(e){return[Math.min(e[0],e[1]),Math.max(e[0],e[1])]}function i(e,t){return e[0]-t[0]||e[1]-t[1]}function o(e){return e.map(r).sort(i)}function a(e,t,n){return t in e?e[t]:n}function u(e,t,n){Array.isArray(t)?(n=n||{},t=t||[]):(n=t||{},t=[]);var r=!!a(n,"delaunay",!0),i=!!a(n,"interior",!0),u=!!a(n,"exterior",!0),h=!!a(n,"infinity",!1);if(!i&&!u||0===e.length)return[];var d=s(e,t);if(r||i!==u||h){for(var v=l(e.length,o(t)),p=0;p<d.length;++p){var y=d[p];v.addTriangle(y[0],y[1],y[2])}return r&&c(e,v),u?i?h?f(v,0,h):v.cells():f(v,1,h):f(v,-1)}return d}var s=n(30),l=n(33),c=n(34),f=n(36);e.exports=u},function(e,t,n){"use strict";function r(e,t,n,r,i){this.a=e,this.b=t,this.idx=n,this.lowerIds=r,this.upperIds=i}function i(e,t,n,r){this.a=e,this.b=t,this.type=n,this.idx=r}function o(e,t){var n=e.a[0]-t.a[0]||e.a[1]-t.a[1]||e.type-t.type;return n||(e.type!==v&&(n=d(e.a,e.b,t.b))?n:e.idx-t.idx)}function a(e,t){return d(e.a,e.b,t)}function u(e,t,n,r,i){for(var o=h.lt(t,r,a),u=h.gt(t,r,a),s=o;s<u;++s){for(var l=t[s],c=l.lowerIds,f=c.length;f>1&&d(n[c[f-2]],n[c[f-1]],r)>0;)e.push([c[f-1],c[f-2],i]),f-=1;c.length=f,c.push(i);for(var v=l.upperIds,f=v.length;f>1&&d(n[v[f-2]],n[v[f-1]],r)<0;)e.push([v[f-2],v[f-1],i]),f-=1;v.length=f,v.push(i)}}function s(e,t){var n;return(n=e.a[0]<t.a[0]?d(e.a,e.b,t.a):d(t.b,t.a,e.a))?n:(n=t.b[0]<e.b[0]?d(e.a,e.b,t.b):d(t.b,t.a,e.b))||e.idx-t.idx}function l(e,t,n){var i=h.le(e,n,s),o=e[i],a=o.upperIds,u=a[a.length-1];o.upperIds=[u],e.splice(i+1,0,new r(n.a,n.b,n.idx,[u],a))}function c(e,t,n){var r=n.a;n.a=n.b,n.b=r;var i=h.eq(e,n,s),o=e[i];e[i-1].upperIds=o.upperIds,e.splice(i,1)}function f(e,t){for(var n=e.length,a=t.length,s=[],f=0;f<n;++f)s.push(new i(e[f],null,v,f));for(var f=0;f<a;++f){var h=t[f],d=e[h[0]],g=e[h[1]];d[0]<g[0]?s.push(new i(d,g,y,f),new i(g,d,p,f)):d[0]>g[0]&&s.push(new i(g,d,y,f),new i(d,g,p,f))}s.sort(o);for(var b=s[0].a[0]-(1+Math.abs(s[0].a[0]))*Math.pow(2,-52),w=[new r([b,1],[b,0],-1,[],[],[],[])],P=[],f=0,m=s.length;f<m;++f){var x=s[f],O=x.type;O===v?u(P,w,e,x.a,x.idx):O===y?l(w,e,x):c(w,e,x)}return P}var h=n(2),d=n(31)[3],v=0,p=1,y=2;e.exports=f},function(e,t,n){"use strict";function r(e,t){for(var n=new Array(e.length-1),r=1;r<e.length;++r)for(var i=n[r-1]=new Array(e.length-1),o=0,a=0;o<e.length;++o)o!==t&&(i[a++]=e[r][o]);return n}function i(e){for(var t=new Array(e),n=0;n<e;++n){t[n]=new Array(e);for(var r=0;r<e;++r)t[n][r]=["m",r,"[",e-n-1,"]"].join("")}return t}function o(e){return 1&e?"-":""}function a(e){if(1===e.length)return e[0];if(2===e.length)return["sum(",e[0],",",e[1],")"].join("");var t=e.length>>1;return["sum(",a(e.slice(0,t)),",",a(e.slice(t)),")"].join("")}function u(e){if(2===e.length)return[["sum(prod(",e[0][0],",",e[1][1],"),prod(-",e[0][1],",",e[1][0],"))"].join("")];for(var t=[],n=0;n<e.length;++n)t.push(["scale(",a(u(r(e,n))),",",o(n),e[0][n],")"].join(""));return t}function s(e){for(var t=[],n=[],o=i(e),s=[],l=0;l<e;++l)0==(1&l)?t.push.apply(t,u(r(o,l))):n.push.apply(n,u(r(o,l))),s.push("m"+l);var v=a(t),p=a(n),y="orientation"+e+"Exact",g=["function ",y,"(",s.join(),"){var p=",v,",n=",p,",d=sub(p,n);return d[d.length-1];};return ",y].join("");return new Function("sum","prod","scale","sub",g)(f,c,h,d)}function l(e){var t=g[e.length];return t||(t=g[e.length]=s(e.length)),t.apply(void 0,e)}var c=n(3),f=n(9),h=n(10),d=n(11),v=5,p=s(3),y=s(4),g=[function(){return 0},function(){return 0},function(e,t){return t[0]-e[0]},function(e,t,n){var r,i=(e[1]-n[1])*(t[0]-n[0]),o=(e[0]-n[0])*(t[1]-n[1]),a=i-o;if(i>0){if(o<=0)return a;r=i+o}else{if(!(i<0))return a;if(o>=0)return a;r=-(i+o)}var u=3.3306690738754716e-16*r;return a>=u||a<=-u?a:p(e,t,n)},function(e,t,n,r){var i=e[0]-r[0],o=t[0]-r[0],a=n[0]-r[0],u=e[1]-r[1],s=t[1]-r[1],l=n[1]-r[1],c=e[2]-r[2],f=t[2]-r[2],h=n[2]-r[2],d=o*l,v=a*s,p=a*u,g=i*l,b=i*s,w=o*u,P=c*(d-v)+f*(p-g)+h*(b-w),m=(Math.abs(d)+Math.abs(v))*Math.abs(c)+(Math.abs(p)+Math.abs(g))*Math.abs(f)+(Math.abs(b)+Math.abs(w))*Math.abs(h),x=7.771561172376103e-16*m;return P>x||-P>x?P:y(e,t,n,r)}];!function(){for(;g.length<=v;)g.push(s(g.length));for(var t=[],n=["slow"],r=0;r<=v;++r)t.push("a"+r),n.push("o"+r);for(var i=["function getOrientation(",t.join(),"){switch(arguments.length){case 0:case 1:return 0;"],r=2;r<=v;++r)i.push("case ",r,":return o",r,"(",t.slice(0,r).join(),");");i.push("}var s=new Array(arguments.length);for(var i=0;i<arguments.length;++i){s[i]=arguments[i]};return slow(s);}return getOrientation"),n.push(i.join(""));var o=Function.apply(void 0,n);e.exports=o.apply(void 0,[l].concat(g));for(var r=0;r<=v;++r)e.exports[r]=g[r]}()},function(e,t,n){"use strict";function r(e,t,n){var r=e+t,i=r-e,o=r-i,a=t-i,u=e-o;return n?(n[0]=u+a,n[1]=r,n):[u+a,r]}e.exports=r},function(e,t,n){"use strict";function r(e,t){this.stars=e,this.edges=t}function i(e,t,n){for(var r=1,i=e.length;r<i;r+=2)if(e[r-1]===t&&e[r]===n)return e[r-1]=e[i-2],e[r]=e[i-1],void(e.length=i-2)}function o(e,t){for(var n=new Array(e),i=0;i<e;++i)n[i]=[];return new r(n,t)}var a=n(2);e.exports=o;var u=r.prototype;u.isConstraint=function(){function e(e,t){return e[0]-t[0]||e[1]-t[1]}var t=[0,0];return function(n,r){return t[0]=Math.min(n,r),t[1]=Math.max(n,r),a.eq(this.edges,t,e)>=0}}(),u.removeTriangle=function(e,t,n){var r=this.stars;i(r[e],t,n),i(r[t],n,e),i(r[n],e,t)},u.addTriangle=function(e,t,n){var r=this.stars;r[e].push(t,n),r[t].push(n,e),r[n].push(e,t)},u.opposite=function(e,t){for(var n=this.stars[t],r=1,i=n.length;r<i;r+=2)if(n[r]===e)return n[r-1];return-1},u.flip=function(e,t){var n=this.opposite(e,t),r=this.opposite(t,e);this.removeTriangle(e,t,n),this.removeTriangle(t,e,r),this.addTriangle(e,r,n),this.addTriangle(t,n,r)},u.edges=function(){for(var e=this.stars,t=[],n=0,r=e.length;n<r;++n)for(var i=e[n],o=0,a=i.length;o<a;o+=2)t.push([i[o],i[o+1]]);return t},u.cells=function(){for(var e=this.stars,t=[],n=0,r=e.length;n<r;++n)for(var i=e[n],o=0,a=i.length;o<a;o+=2){var u=i[o],s=i[o+1];n<Math.min(u,s)&&t.push([n,u,s])}return t}},function(e,t,n){"use strict";function r(e,t,n,r,i,a){var u=t.opposite(r,i);if(!(u<0)){if(i<r){var s=r;r=i,i=s,s=a,a=u,u=s}t.isConstraint(r,i)||o(e[r],e[i],e[a],e[u])<0&&n.push(r,i)}}function i(e,t){for(var n=[],i=e.length,a=t.stars,u=0;u<i;++u)for(var s=a[u],l=1;l<s.length;l+=2){var c=s[l];if(!(c<u)&&!t.isConstraint(u,c)){for(var f=s[l-1],h=-1,d=1;d<s.length;d+=2)if(s[d-1]===c){h=s[d];break}h<0||o(e[u],e[c],e[f],e[h])<0&&n.push(u,c)}}for(;n.length>0;){for(var c=n.pop(),u=n.pop(),f=-1,h=-1,s=a[u],v=1;v<s.length;v+=2){var p=s[v-1],y=s[v];p===c?h=y:y===c&&(f=p)}f<0||h<0||(o(e[u],e[c],e[f],e[h])>=0||(t.flip(u,c),r(e,t,n,f,u,h),r(e,t,n,u,h,f),r(e,t,n,h,c,f),r(e,t,n,c,f,h)))}}var o=n(35)[4];n(2);e.exports=i},function(e,t,n){"use strict";function r(e,t){for(var n=new Array(e.length-1),r=1;r<e.length;++r)for(var i=n[r-1]=new Array(e.length-1),o=0,a=0;o<e.length;++o)o!==t&&(i[a++]=e[r][o]);return n}function i(e){for(var t=new Array(e),n=0;n<e;++n){t[n]=new Array(e);for(var r=0;r<e;++r)t[n][r]=["m",r,"[",e-n-2,"]"].join("")}return t}function o(e){if(1===e.length)return e[0];if(2===e.length)return["sum(",e[0],",",e[1],")"].join("");var t=e.length>>1;return["sum(",o(e.slice(0,t)),",",o(e.slice(t)),")"].join("")}function a(e,t){if("m"===e.charAt(0)){if("w"===t.charAt(0)){var n=e.split("[");return["w",t.substr(1),"m",n[0].substr(1)].join("")}return["prod(",e,",",t,")"].join("")}return a(t,e)}function u(e){return!0&e?"-":""}function s(e){if(2===e.length)return[["diff(",a(e[0][0],e[1][1]),",",a(e[1][0],e[0][1]),")"].join("")];for(var t=[],n=0;n<e.length;++n)t.push(["scale(",o(s(r(e,n))),",",u(n),e[0][n],")"].join(""));return t}function l(e,t){for(var n=[],r=0;r<t-2;++r)n.push(["prod(m",e,"[",r,"],m",e,"[",r,"])"].join(""));return o(n)}function c(e){for(var t=[],n=[],a=i(e),u=0;u<e;++u)a[0][u]="1",a[e-1][u]="w"+u;for(var u=0;u<e;++u)0==(1&u)?t.push.apply(t,s(r(a,u))):n.push.apply(n,s(r(a,u)));for(var c=o(t),f=o(n),h="exactInSphere"+e,d=[],u=0;u<e;++u)d.push("m"+u);for(var v=["function ",h,"(",d.join(),"){"],u=0;u<e;++u){v.push("var w",u,"=",l(u,e),";");for(var w=0;w<e;++w)w!==u&&v.push("var w",u,"m",w,"=scale(w",u,",m",w,"[0]);")}return v.push("var p=",c,",n=",f,",d=diff(p,n);return d[d.length-1];}return ",h),new Function("sum","diff","prod","scale",v.join(""))(y,g,p,b)}function f(){return 0}function h(){return 0}function d(){return 0}function v(e){var t=P[e.length];return t||(t=P[e.length]=c(e.length)),t.apply(void 0,e)}var p=n(3),y=n(9),g=n(11),b=n(10),w=6,P=[f,h,d];!function(){for(;P.length<=w;)P.push(c(P.length));for(var t=[],n=["slow"],r=0;r<=w;++r)t.push("a"+r),n.push("o"+r);for(var i=["function testInSphere(",t.join(),"){switch(arguments.length){case 0:case 1:return 0;"],r=2;r<=w;++r)i.push("case ",r,":return o",r,"(",t.slice(0,r).join(),");");i.push("}var s=new Array(arguments.length);for(var i=0;i<arguments.length;++i){s[i]=arguments[i]};return slow(s);}return testInSphere"),n.push(i.join(""));var o=Function.apply(void 0,n);e.exports=o.apply(void 0,[v].concat(P));for(var r=0;r<=w;++r)e.exports[r]=P[r]}()},function(e,t,n){"use strict";function r(e,t,n,r,i,o,a){this.cells=e,this.neighbor=t,this.flags=r,this.constraint=n,this.active=i,this.next=o,this.boundary=a}function i(e,t){return e[0]-t[0]||e[1]-t[1]||e[2]-t[2]}function o(e,t){for(var n=e.cells(),o=n.length,a=0;a<o;++a){var u=n[a],s=u[0],l=u[1],c=u[2];l<c?l<s&&(u[0]=l,u[1]=c,u[2]=s):c<s&&(u[0]=c,u[1]=s,u[2]=l)}n.sort(i);for(var f=new Array(o),a=0;a<f.length;++a)f[a]=0;var h=[],d=[],v=new Array(3*o),p=new Array(3*o),y=null;t&&(y=[]);for(var g=new r(n,v,p,f,h,d,y),a=0;a<o;++a)for(var u=n[a],b=0;b<3;++b){var s=u[b],l=u[(b+1)%3],w=v[3*a+b]=g.locate(l,s,e.opposite(l,s)),P=p[3*a+b]=e.isConstraint(s,l);w<0&&(P?d.push(a):(h.push(a),f[a]=1),t&&y.push([l,s,-1]))}return g}function a(e,t,n){for(var r=0,i=0;i<e.length;++i)t[i]===n&&(e[r++]=e[i]);return e.length=r,e}function u(e,t,n){var r=o(e,n);if(0===t)return n?r.cells.concat(r.boundary):r.cells;for(var i=1,u=r.active,s=r.next,l=r.flags,c=r.cells,f=r.constraint,h=r.neighbor;u.length>0||s.length>0;){for(;u.length>0;){var d=u.pop();if(l[d]!==-i){l[d]=i;for(var v=(c[d],0);v<3;++v){var p=h[3*d+v];p>=0&&0===l[p]&&(f[3*d+v]?s.push(p):(u.push(p),l[p]=i))}}}var y=s;s=u,u=y,s.length=0,i=-i}var g=a(c,l,t);return n?g.concat(r.boundary):g}var s=n(2);e.exports=u,r.prototype.locate=function(){var e=[0,0,0];return function(t,n,r){var o=t,a=n,u=r;return n<r?n<t&&(o=n,a=r,u=t):r<t&&(o=r,a=t,u=n),o<0?-1:(e[0]=o,e[1]=a,e[2]=u,s.eq(this.cells,e,i))}}()}])});
//# sourceMappingURL=navmesh-plugin.js.map